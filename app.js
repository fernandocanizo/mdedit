// Creation Date: 2015.07.12

"use strict";


var express = require('express');
var app = express();


////////////////////////////////////////////////////////////////////////////////
// Configuration
////////////////////////////////////////////////////////////////////////////////

app.set('view engine', 'ejs');


////////////////////////////////////////////////////////////////////////////////
// Middleware
////////////////////////////////////////////////////////////////////////////////

app.use(express.static(__dirname + '/public'));

switch(app.get('env')) {
	case 'development':
		app.use(require('morgan')('dev'));
		break;

	case 'production':
		app.use(require('express-logger')({
			path: __dirname + '/log/requests.log'
		}));
		break;
}


////////////////////////////////////////////////////////////////////////////////
// Routes
////////////////////////////////////////////////////////////////////////////////

app.get('/', function (req, res) {
	res.render('pad');
});


////////////////////////////////////////////////////////////////////////////////
// Web Server
////////////////////////////////////////////////////////////////////////////////

// Get port from environment and store in Express.
app.set('port', (undefined === process.env.PORT)? '3000' : process.env.PORT);

// Start web server
app.listen(app.get('port'), function () {
	console.log("Express started in " + app.get('env') + " mode. Listening on http://localhost:" + app.get('port'));
});

